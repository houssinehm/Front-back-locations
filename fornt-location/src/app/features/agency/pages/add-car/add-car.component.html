<div class="p-4 md:p-6">
  <div class="mb-4 md:mb-6">
    <h1 class="text-xl md:text-2xl font-bold">Add a New Car</h1>
    <p class="text-gray-600">
      Fill in the details to add a new car to your inventory.
    </p>
  </div>

  <form
    [formGroup]="carForm"
    (ngSubmit)="onSubmit()"
    class="bg-white rounded-lg p-4 md:p-6 shadow-sm"
  >
    <h2 class="text-lg md:text-xl font-semibold mb-4 md:mb-6">Car Details</h2>
    <p class="text-gray-600 mb-4 md:mb-6">
      Enter the basic information about the car you want to add.
    </p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
      <!-- Brand -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Brand</label
        >
        <select
          formControlName="brand"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#FFC107]"
         [ngClass]="{'border-red-500': carForm.get('brand')?.invalid && carForm.get('brand')?.touched}"
          >
          <option value="">Select car brand</option>
          <option value="acura">Acura</option>
          <option value="alfa_romeo">Alfa Romeo</option>
          <option value="aston_martin">Aston Martin</option>
          <option value="audi">Audi</option>
          <option value="bentley">Bentley</option>
          <option value="bmw">BMW</option>
          <option value="bugatti">Bugatti</option>
          <option value="byd">BYD</option>
          <option value="cadillac">Cadillac</option>
          <option value="chevrolet">Chevrolet</option>
          <option value="chrysler">Chrysler</option>
          <option value="citroen">Citroën</option>
          <option value="dacia">Dacia</option>
          <option value="dodge">Dodge</option>
          <option value="ds">DS</option>
          <option value="ferrari">Ferrari</option>
          <option value="fiat">Fiat</option>
          <option value="ford">Ford</option>
          <option value="geely">Geely</option>
          <option value="great_wall">Great Wall</option>
          <option value="honda">Honda</option>
          <option value="hyundai">Hyundai</option>
          <option value="infiniti">Infiniti</option>
          <option value="iveco">Iveco</option>
          <option value="jaguar">Jaguar</option>
          <option value="jeep">Jeep</option>
          <option value="kia">Kia</option>
          <option value="koenigsegg">Koenigsegg</option>
          <option value="lamborghini">Lamborghini</option>
          <option value="land_rover">Land Rover</option>
          <option value="lexus">Lexus</option>
          <option value="lincoln">Lincoln</option>
          <option value="lotus">Lotus</option>
          <option value="lucid">Lucid</option>
          <option value="man">MAN</option>
          <option value="maserati">Maserati</option>
          <option value="maybach">Maybach</option>
          <option value="mazda">Mazda</option>
          <option value="mclaren">McLaren</option>
          <option value="mercedes_benz">Mercedes-Benz</option>
          <option value="mini">Mini</option>
          <option value="mitsubishi">Mitsubishi</option>
          <option value="nio">Nio</option>
          <option value="nissan">Nissan</option>
          <option value="opel">Opel</option>
          <option value="pagani">Pagani</option>
          <option value="peugeot">Peugeot</option>
          <option value="polestar">Polestar</option>
          <option value="porsche">Porsche</option>
          <option value="ram">RAM</option>
          <option value="renault">Renault</option>
          <option value="rivian">Rivian</option>
          <option value="rolls_royce">Rolls-Royce</option>
          <option value="saic">SAIC</option>
          <option value="scania">Scania</option>
          <option value="seat">SEAT</option>
          <option value="skoda">Skoda</option>
          <option value="smart">Smart</option>
          <option value="ssangyong">SsangYong</option>
          <option value="subaru">Subaru</option>
          <option value="suzuki">Suzuki</option>
          <option value="tesla">Tesla</option>
          <option value="toyota">Toyota</option>
          <option value="volkswagen">Volkswagen</option>
          <option value="volvo">Volvo</option>
          <option value="xpeng">Xpeng</option>
        </select>
        <div class="text-red-500 text-sm mt-1"
                *ngIf="carForm.get('brand')?.invalid && carForm.get('brand')?.touched">
                la marque n'est pas ajouté.
            </div>
      </div>

      <!-- Model -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Model</label
        >
        <input
          type="text"
          formControlName="model"
          placeholder="Enter car model"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#FFC107]" 
           [ngClass]="{'border-red-500': carForm.get('model')?.invalid && carForm.get('model')?.touched}"
          
        />

         <div class="text-red-500 text-sm mt-1"
                *ngIf="carForm.get('model')?.invalid && carForm.get('model')?.touched">
                le model n'est pas ajouté.
            </div>
      </div>

      <!-- Car Type -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Car Type</label
        >
        <select
          formControlName="type"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#FFC107]"
             [ngClass]="{'border-red-500': carForm.get('type')?.invalid && carForm.get('type')?.touched}"        
          >
          <option value="">Select car type</option>
          <option value="citadine">Citadine</option>
          <option value="compacte">Compacte</option>
          <option value="berline">Berline</option>
          <option value="suv">SUV</option>
          <option value="monospace">Monospace</option>
          <option value="coupe">Coupé</option>
          <option value="cabriolet">Cabriolet</option>
          <option value="luxe">Luxe</option>
          <option value="pickup">Pickup</option>
          <option value="van">Van</option>
          <option value="minibus">Minibus</option>
        </select>

         <div class="text-red-500 text-sm mt-1"
                *ngIf="carForm.get('type')?.invalid && carForm.get('type')?.touched">
                le type n'est pas ajouté.
            </div>
      </div>

      <!-- Fuel Type -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Fuel Type</label
        >
        <select
          formControlName="fuel"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#FFC107]"
          [ngClass]="{'border-red-500': carForm.get('fuel')?.invalid && carForm.get('fuel')?.touched}"
          >
          <option value="">Select fuel type</option>
          <option value="essence">Essence</option>
          <option value="diesel">Diesel</option>
          <option value="electric">Electric</option>
          <option value="hybrid">Hybrid</option>
        </select>
         <div class="text-red-500 text-sm mt-1"
                *ngIf="carForm.get('fuel')?.invalid && carForm.get('fuel')?.touched">
                le fuel n'est pas ajouté.
            </div>
      </div>

      <!-- Gearbox -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Gearbox</label
        >
        <select
          formControlName="gearbox"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#FFC107]"
          [ngClass]="{'border-red-500': carForm.get('gearbox')?.invalid && carForm.get('gearbox')?.touched}"
          >
          <option value="">Select gearbox type</option>
          <option value="manual">Manual</option>
          <option value="automatic">Automatic</option>
        </select>

         <div class="text-red-500 text-sm mt-1"
                *ngIf="carForm.get('gearbox')?.invalid && carForm.get('gearbox')?.touched">
                le gearbox n'est pas ajouté.
            </div>
      </div>

      <!-- Number of Seats -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Number of Seats</label
        >
        <input
          type="number"
          formControlName="number_place"
          min="1"
          max="15"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#FFC107]"
            [ngClass]="{'border-red-500': carForm.get('number_place')?.invalid && carForm.get('number_place')?.touched}"
        />
        <div class="text-red-500 text-sm mt-1"
                *ngIf="carForm.get('number_place')?.invalid && carForm.get('number_place')?.touched">
                le nombre de place n'est pas valide.
            </div>
      </div>
      

      <!-- Number of Doors -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Number of Doors</label
        >
        <input
          type="number"
          formControlName="number_door"
          min="2"
          max="8"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#FFC107]"
          [ngClass]="{'border-red-500': carForm.get('number_door')?.invalid && carForm.get('number_door')?.touched}"
        />
        <div class="text-red-500 text-sm mt-1"
                *ngIf="carForm.get('number_door')?.invalid && carForm.get('number_door')?.touched">
                le nombre de porte n'est pas valide.
            </div>
      </div>

      <!-- Minimum Driver Age -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Minimum Required License Level</label
        >
        <select
          formControlName="driving_license_min_year"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#FFC107]"
             [ngClass]="{'border-red-500': carForm.get('driving_license_min_year')?.invalid && carForm.get('driving_license_min_year')?.touched}"
        >
          <option value="0">0 year</option>
          <option value="1">1 year</option>
          <option value="2">2 years</option>
          <option value="3">3 years</option>
          <option value="4">4 years</option>
          <option value="5">5 years</option>
          <option value="6">6 years</option>
          <option value="7">7 years</option>
          <option value="8">8 years</option>
          <option value="9">9 years</option>
          <option value="10">10 years</option>
          <option value="11">11 years</option>
          <option value="12">12 years</option>
          <option value="13">13 years</option>
          <option value="14">14 years</option>
          <option value="15">15 years</option>
        </select>
        <div class="text-red-500 text-sm mt-1"
                *ngIf="carForm.get('driving_license_min_year')?.invalid && carForm.get('driving_license_min_year')?.touched">
                le nombre d'année est invalide.
            </div>
      </div>

      <!-- Luggage Capacity -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Luggage Capacity (Number of Bags)</label
        >
        <input
          type="number"
          formControlName="number_bag"
          min="0"
          max="10"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#FFC107]"
            [ngClass]="{'border-red-500': carForm.get('number_bag')?.invalid && carForm.get('number_bag')?.touched}"
        />
        <div class="text-red-500 text-sm mt-1"
                *ngIf="carForm.get('number_bag')?.invalid && carForm.get('number_bag')?.touched">
                le nombre d'année est invalide.
            </div>
      </div>

      <!-- Deposit Amount -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Deposit Amount ($)</label
        >
        <input
          type="number"
          formControlName="caution"
          min="0"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#FFC107]"
             [ngClass]="{'border-red-500': carForm.get('caution')?.invalid && carForm.get('caution')?.touched}"
        />
        <div class="text-red-500 text-sm mt-1"
                *ngIf="carForm.get('caution')?.invalid && carForm.get('caution')?.touched">
                le nombre d'année est invalide.
            </div>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">City</label>
        <select
          formControlName="city"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#FFC107]"
           [ngClass]="{'border-red-500': carForm.get('city')?.invalid && carForm.get('city')?.touched}"
        >
          <option value="RABAT">RABAT</option>
          <option value="FES">FES</option>
          <option value="TANGER">TANGER</option>
          <option value="CASABLANCA">CASABLANCA</option>
          <option value="AGADIR">AGADIR</option>
          <option value="MARRAKECH">MARRAKECH</option>
        </select>
         <div class="text-red-500 text-sm mt-1"
                *ngIf="carForm.get('city')?.invalid && carForm.get('city')?.touched">
                le nombre d'année est invalide.
            </div>
      </div>

      <!-- minimum age driver  -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2"
          >Minimum driver age</label
        >
        <input
          type="number"
          formControlName="age_min"
          min="18"
          max="80"
          class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#FFC107]"
           [ngClass]="{'border-red-500': carForm.get('age_min')?.invalid && carForm.get('age_min')?.touched}"
        />
        <div class="text-red-500 text-sm mt-1"
                *ngIf="carForm.get('age_min')?.invalid && carForm.get('age_min')?.touched">
                le nombre d'année est invalide.
            </div>
      </div>
    </div>

    <!-- Features -->
    <div class="mt-4 md:mt-6">
      <div class="flex flex-col md:flex-row md:items-center gap-4 md:gap-6">
        <label class="flex items-center">
          <input
            type="checkbox"
            formControlName="clim"
            class="form-checkbox text-[#FFC107] rounded"
          />
          <span class="ml-2">Air Conditioning</span>
        </label>
      </div>
    </div>

    <!-- Upload Photos -->
    <div class="mt-4 md:mt-6">
      <label class="block text-sm font-medium text-gray-700 mb-2"
        >Upload Photos</label
      >
      <div
        class="border-2 border-dashed border-gray-300 rounded-lg p-4 md:p-6 text-center cursor-pointer"
        (click)="fileInput.click()"
        (dragover)="onDragOver($event)"
        (drop)="onDrop($event)"
      >
        <input
          #fileInput
          type="file"
          accept="image/*"
          multiple
          class="hidden"
          (change)="onFileSelected($event)"
        />
        <span class="material-icons text-3xl md:text-4xl text-gray-400"
          >cloud_upload</span
        >
        <p class="mt-2 text-sm md:text-base text-gray-600">
          Drag and drop image files here, or click to browse
        </p>
        <p class="mt-1 text-xs text-gray-500">
          Supported formats: JPG, PNG, WEBP
        </p>
      </div>

      <!-- Preview Area -->
      <div
        *ngIf="selectedFiles.length > 0"
        class="mt-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4"
      >
        <div
          *ngFor="let file of selectedFiles; let i = index"
          class="relative group aspect-video bg-gray-100 rounded-lg overflow-hidden"
        >
          <img
            [src]="file.preview"
            [alt]="file.name"
            class="w-full h-full object-cover"
          />
          <div
            class="absolute inset-0 bg-black bg-opacity-40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center"
          >
            <button
              type="button"
              (click)="removeFile(i)"
              class="p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors"
            >
              <span class="material-icons text-sm">close</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Buttons -->
    <div
      class="mt-6 md:mt-8 flex flex-col md:flex-row justify-end gap-3 md:gap-4"
    >
      <button
        type="button"
        class="w-full md:w-auto px-6 py-2 border border-gray-300 rounded-lg text-gray-700"
      >
        Cancel
      </button>
      <button
        type="submit"
        [disabled]="carForm.invalid || loading"
        class="w-full md:w-auto px-6 py-2 bg-[#FFC107] text-black rounded-lg"
      >
        <div *ngIf="loading" class="flex">
          <svg
            *ngIf="loading"
            class="animate-spin h-5 w-5 mr-2 text-white"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
          >
            <circle
              class="opacity-25"
              cx="12"
              cy="12"
              r="10"
              stroke="currentColor"
              stroke-width="4"
            ></circle>
            <path
              class="opacity-75"
              fill="currentColor"
              d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"
            ></path>
          </svg>
          <span>Connexion...</span>
        </div>

        <span *ngIf="!loading">Add Car</span>
      </button>
    </div>
  </form>
</div>
